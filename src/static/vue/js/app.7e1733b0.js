(function(t){function e(e){for(var a,i,n=e[0],c=e[1],l=e[2],u=0,m=[];u<n.length;u++)i=n[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);d&&d(e);while(m.length)m.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,n=1;n<s.length;n++){var c=s[n];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=s[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=a,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=e,n=n.slice();for(var l=0;l<n.length;l++)e(n[l]);var d=c;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"02b8":function(t,e,s){"use strict";var a=s("6ea3"),o=s.n(a);o.a},"034f":function(t,e,s){"use strict";var a=s("85ec"),o=s.n(a);o.a},"0bb8":function(t,e,s){"use strict";var a=s("f63f"),o=s.n(a);o.a},"0fb7":function(t,e,s){"use strict";var a=s("776b"),o=s.n(a);o.a},1:function(t,e){},"184c":function(t,e,s){"use strict";var a=s("8b9e"),o=s.n(a);o.a},"197c":function(t,e,s){},"22d8":function(t,e,s){"use strict";var a=s("197c"),o=s.n(a);o.a},"3fbf":function(t,e,s){"use strict";var a=s("f554"),o=s.n(a);o.a},"56d7":function(t,e,s){"use strict";s.r(e);s("e623"),s("e379"),s("5dc8"),s("37e1");var a=s("2b0e"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("html",{attrs:{lang:"ko"}},[t._m(0),s("body",[s("div",{attrs:{id:"app"}},[s("div",{staticClass:"nav-bar"},[s("nav-bar")],1),s("div",{staticClass:"wrapper"},[s("div",{staticClass:"side-bar bg-dark"},[s("side-bar")],1),s("div",{staticClass:"content"},[s("router-view")],1)])])])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("head",[s("link",{attrs:{rel:"stylesheet",href:"win98.css"}}),s("link",{attrs:{rel:"stylesheet",href:"bootstrap-social.css"}})])}],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"side-bar d-flex flex-column"}},[s("profile",{staticClass:"pt-1 pb-3"}),s("div",{staticClass:"pt-2 px-1"},[s("p",{staticClass:"text-light font-weight-light mb-1"},[t._v("전체 단어 순위")]),s("ol",{attrs:{id:"total"}},t._l(t.ranks,(function(e){return s("li",{key:e.correct,staticClass:"list-group-item"},[s("span",{staticClass:"rank-context"},[t._v(t._s(e.wrong+" → "+e.correct))])])})),0),!0===this.$store.state.loggedin?s("div",[s("p",{staticClass:"text-light font-weight-light mb-1"},[t._v("개인 단어 순위")]),s("ol",{attrs:{id:"user"}},t._l(t.users,(function(e){return s("li",{key:e.correct,staticClass:"list-group-item"},[s("span",{staticClass:"rank-context"},[t._v(t._s(e.wrong+" → "+e.correct))])])})),0)]):t._e()])],1)},n=[],c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"profile d-flex flex-column"},[!1===this.$store.state.loggedin?s("div",[s("div",{staticClass:"d-flex flex-column card m-2"},[s("i",{staticClass:"profile-photo"},[s("font-awesome-icon",{attrs:{icon:"user-secret"}})],1),t._m(0)]),s("div",{staticClass:"d-flex flex-column card m-2"},[s("router-link",{attrs:{to:{name:"Login"}}},[s("button",{staticClass:"btn btn-sm btn-light"},[t._v("로그인")])])],1)]):s("div",[s("div",{staticClass:"d-flex flex-column card bg-light m-2"},[s("div",[s("a",{staticClass:"text-dark small",on:{click:t.editProfile}},[t._v(" edit "),s("font-awesome-icon",{attrs:{icon:"pencil-alt"}})],1)]),s("div",{staticClass:"img_wrapper"},[s("img",{staticClass:"rounded-circle img mt-1",staticStyle:{width:"100px",height:"100px"},attrs:{src:t.user_img}})]),s("span",{staticClass:"mt-1"},[t._v(t._s(this.$store.state.user.nickname))]),s("span",{staticClass:"mt-1"},[t._v(t._s(this.$store.state.user.profile_message))]),s("span",{staticClass:"my-1"},[t._v(t._s(this.$store.state.user.grade))])]),s("div",{staticClass:"row mx-auto px-2 align-items-center justify-content-center"},[s("router-link",{staticClass:"btn btn-sm btn-light col-6 border-dark",staticStyle:{"font-size":"smaller"},attrs:{to:{name:"Room",params:{user_id:[this.$store.state.user.id],room_number:this.$store.state.user.myroom}},tag:"button"}},[t._v(" 나와의 채팅 ")]),s("button",{staticClass:"btn btn-sm btn-light col-6 border-dark",staticStyle:{"font-size":"smaller"},on:{click:t.logout}},[t._v("퇴장")])],1),s("div",[s("edit-profile")],1)])])},l=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("p",[t._v("로그인이 필요합니다! ")])])}],d=s("bc3a"),u=s.n(d),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"edit-profile"}},[s("b-modal",{attrs:{id:"newEditProfileModal","hide-footer":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" 프로필 수정하기 ")]},proxy:!0}])},[s("div",{staticClass:"mb-3 card"},[s("div",[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"file"}},[t._v("프로필 사진 변경")]),s("input",{ref:"file",staticClass:"form-control-file form-control",attrs:{type:"file",id:"file",name:"file"},on:{change:function(e){return t.handleFileUpload()}}})]),s("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.submitFile()}}},[t._v("올리기")])])]),s("div",{staticClass:"card"},[s("form",{staticClass:"form-profile",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.edit(e)}}},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label mr-auth",attrs:{for:"nickname"}},[t._v("가명:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.profile.nickname,expression:"profile.nickname"}],staticClass:"form-control",attrs:{type:"text",id:"nickname"},domProps:{value:t.profile.nickname},on:{input:function(e){e.target.composing||t.$set(t.profile,"nickname",e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label mr-auth",attrs:{for:"profile_message"}},[t._v("대화명:")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.profile.profile_message,expression:"profile.profile_message"}],staticClass:"form-control",attrs:{type:"text",id:"profile_message"},domProps:{value:t.profile.profile_message},on:{input:function(e){e.target.composing||t.$set(t.profile,"profile_message",e.target.value)}}})]),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit",value:"submit"}},[t._v("저장하기")])])])])],1)},f=[],h={name:"EditProfile",data:function(){return{success:!1,profile:{},file:""}},methods:{edit:function(){var t=this;console.log(this.profile);var e=this;u.a.post("/auth/profile/edit",this.profile).then((function(s){console.log("response:"+s),e.$store.commit("updateUser"),e.success=!0,t.$toasted.show("성공적으로 업데이트 했습니다.",{theme:"toasted-primary",icon:"faCheck",type:"success",position:"top-right",duration:3e3})})).catch((function(e){console.log("Cannot update profile:"+e),t.$toasted.show("이미지의 용량이 너무 크거나 잘못된 파일 형식이 입니다.",{theme:"toasted-primary",icon:"faCheck",type:"error",position:"top-right",duration:3e3})}))},handleFileUpload:function(){this.file=this.$refs.file.files[0]},submitFile:function(){var t=this,e=this,s=new FormData;s.append("file",this.file),u.a.post("/auth/profile/image/upload",s,{header:{"Content-Type":"multipart/form-data"}}).then((function(){e.$store.commit("updateUser"),t.$toasted.show("성공적으로 사진을 변경했습니다.",{theme:"toasted-primary",icon:"faCheck",type:"success",position:"top-right",duration:3e3})})).catch((function(t){console.log("Cannot update profile:"+t)}))}},mounted:function(){}},p=h,g=(s("a9f1"),s("2877")),v=Object(g["a"])(p,m,f,!1,null,"59e5d104",null),_=v.exports,b={name:"Profile.Vue",data:function(){return{user_img:this.$store.state.user_img}},created:function(){},components:{"edit-profile":_},methods:{logout:function(){var t=this;u.a.get("/auth/account/logout").then((function(){t.$store.commit("updateUser"),document.location.href="/"})).catch((function(t){console.log(t)}))},editProfile:function(){this.$bvModal.show("newEditProfileModal")}},mounted:function(){var t=this;this.$store.watch(this.$store.getters.getUserImg,(function(e){t.user_img=e}))}},C=b,k=(s("02b8"),Object(g["a"])(C,c,l,!1,null,"11e59119",null)),w=k.exports,x={name:"side-bar",components:{profile:w},methods:{updateTotal:function(){var t=this;u.a.get("/spell").then((function(e){delete e.data.rank_cnt,"undefined"!=typeof e.data.status?console.log("updateTotal err"):t.ranks=e.data})).catch((function(t){console.log(t)}))},updateUser:function(t){var e=this;this.$store.state.loggedin&&u.a.get("/spell/".concat(t)).then((function(t){delete t.data.user_id,delete t.data.rank_cnt,null==t.data.status?e.users=t.data:console.log("updateTotal err")})).catch((function(t){console.log(t)}))}},created:function(){this.updateTotal()},mounted:function(){var t=this;this.$store.watch(this.$store.getters.getUserInfo,(function(e){t.updateTotal(),"undefined"!=typeof e&&t.updateUser(e.id)}))},data:function(){return{ranks:[],users:[]}}},y=x,$=(s("8c4b"),Object(g["a"])(y,i,n,!1,null,"6cd5975a",null)),U=$.exports,I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar navbar-light bg-dark"},[!0===this.$store.state.loggedin?s("div",[s("router-link",{staticClass:"navbar-brand text-light",attrs:{to:{name:"Friend"}}},[t._v("훈민정음")])],1):s("div",[s("router-link",{staticClass:"navbar-brand text-light",attrs:{to:{name:"Login"}}},[t._v("훈민정음")])],1),t._m(0),t.isLogin?s("div",[s("span",{staticClass:"navbar-text mx-2",staticStyle:{position:"relative","z-index":"1"}},[s("router-link",{attrs:{to:{name:"RoomList",params:{user_id:this.$store.state.user.id}}}},[s("i",{staticClass:"nav-icon text-light"},[s("font-awesome-icon",{attrs:{icon:"comment"}})],1),this.$store.state.countChat>0?s("span",{staticClass:"badge badge-danger badge-pill float-right mx-n3",staticStyle:{position:"relative","z-index":"2",left:"-7px"}},[t._v(t._s(this.$store.state.countChat))]):t._e()])],1),s("span",{staticClass:"navbar-text mx-2",staticStyle:{position:"relative","z-index":"1"}},[s("router-link",{attrs:{to:{name:"FriendRequests"}}},[s("i",{staticClass:"nav-icon text-light"},[s("font-awesome-icon",{attrs:{icon:"users"}})],1),this.$store.state.countReq>0?s("span",{staticClass:"badge badge-danger badge-pill float-right mx-n3",staticStyle:{position:"relative","z-index":"2",left:"-7px"}},[t._v(t._s(this.$store.state.countReq))]):t._e()])],1)]):t._e()])},R=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"navbar-nav mr-auto mt-2 mt-lg-0"},[s("li",{staticClass:"nav-item active text-light"})])}],S=(s("c740"),s("a434"),s("8055")),O=s.n(S),E=s("db49"),M=s.n(E),T={name:"nav-bar",data:function(){return{isLogin:!1,socket:void 0,userId:null}},mounted:function(){var t=this;this.$store.watch(this.$store.getters.getUserLogin,(function(e){t.isLogin=e,e?(t.userId=t.$store.state.user.id,t.$store.commit("updateReq"),t.$store.commit("updateFriends"),t.initSocket()):null!=t.userId&&"undefined"!=typeof t.userId&&(t.socket.emit("disconnect",{user:t.userId}),t.userId=null)}))},methods:{initSocket:function(){var t=this;this.socket=O()(M.a.CHAT_URL+"/alarm?user=".concat(this.$store.state.user.id),{transports:["websocket"]}),this.socket.on("server chat message",(function(e){var s=t.$store.state.rooms.findIndex((function(t){return t.id==e}));if(-1===s&&(console.log("roomIdx == -1"),t.$store.commit("updateRoom")),s>0){var a=t.$store.state.rooms[s];t.$store.state.rooms.splice(s,1),t.$store.state.rooms.unshift(a)}e!=t.$store.state.location&&(t.$store.state.rooms[s].unread++,t.$store.state.countChat++)})),this.socket.on("server friend req",(function(e){t.$store.state.countReq++,console.log("count Req:",e)})),this.socket.on("server friend req permit",(function(e){t.$store.commit("updateFriends"),console.log("count Req permit:",e)}))}}},P=T,q=(s("22d8"),Object(g["a"])(P,I,R,!1,null,"773a7200",null)),A=q.exports,F={name:"app",created:function(){this.$store.commit("updateUser")},components:{"nav-bar":A,"side-bar":U}},N=F,j=(s("034f"),Object(g["a"])(N,o,r,!1,null,null,null)),L=j.exports,H=s("8c4f"),D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wrap"},[s("h1",[t._v("Users")]),s("ul",{attrs:{id:"users"}},t._l(t.users,(function(e){return s("li",{key:e.id,staticClass:"list-group-item"},[t._v(" "+t._s(e.email)+" ")])})),0)])},B=[],z={created:function(){var t=this;this.$http.get("/api/users").then((function(e){t.users=e.data}))},data:function(){return{users:[]}}},G=z,J=Object(g["a"])(G,D,B,!1,null,null,null),V=J.exports,K=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Friend"},[s("div",{staticClass:"mt-5 d-flex justify-content-between mb-2"},[s("div"),t._m(0),s("div",{staticClass:"pr-2"},[s("button",{staticClass:"btn btn-primary btn-lg rounded-circle shadow-lg",on:{click:t.addFriend}},[s("i",{staticClass:"nav-icon"},[s("font-awesome-icon",{staticClass:"mt-2 mb-1",attrs:{icon:"user-plus"}})],1)])])]),!1===this.$store.state.loggedin?s("div",[t._m(1)]):s("div",[s("ul",{staticClass:"list-group my-3"},t._l(this.$store.state.friends,(function(e){return s("li",{key:e.id,staticClass:"list-group-item  align-self-center w-75"},[s("div",{staticClass:"row justify-content-between"},[s("div",{staticClass:"col-2 col-md-2  align-self-center"},[s("img",{staticClass:"rounded-circle",attrs:{src:t.images_path+e.image_path,width:"30px",height:"30px"}})]),s("div",{staticClass:"col-auto col-md-3 align-self-center"},[s("div",{staticClass:"row"},[s("div",{staticClass:"text-left"},[t._v(t._s(e.nickname))])]),s("div",{staticClass:"row mb-4 my-auto"},[s("small",[t._v(t._s(e.profile_message))])])]),s("div",{staticClass:"col-2 align-self-center"},[t._v(t._s(e.grade))]),s("div",{staticClass:"col-2 align-self-end"},[s("div",{staticClass:"btn",on:{click:function(s){return t.friendChat(e.id,e.room)}}},[s("font-awesome-icon",{staticClass:"fa-2x",attrs:{icon:"comment"}})],1)])])])})),0)]),s("div",[s("add-friend")],1)])},Z=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h1",{staticClass:"h4"},[t._v("훈민정음")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("p",{staticClass:"text-dark"},[t._v("로그인을 먼저 해주세요! ")])])}],Q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"add-friend"}},[s("b-modal",{attrs:{id:"newAddFriendModal","hide-footer":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" 친구 요청하기 ")]},proxy:!0}])},[s("form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.addFriend(e)}}},[s("div",{staticClass:"input-group mb-2 d-flex flex-column"},[s("label",{staticClass:"align-self-start",attrs:{for:"email"}},[t._v("이메일")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.friend.email,expression:"friend.email"}],staticClass:"form-control",attrs:{type:"email",name:"email",id:"email",required:"",autofocus:""},domProps:{value:t.friend.email},on:{input:function(e){e.target.composing||t.$set(t.friend,"email",e.target.value)}}})]),s("input",{staticClass:"btn btn-lg btn-primary btn-block",attrs:{type:"submit",value:"submit"}})])])],1)},W=[],X={name:"AddFriend",data:function(){return{result:"",friend:{},socket:O()(M.a.CHAT_URL+"/friend",{transports:["websocket"]}),userId:null}},mounted:function(){var t=this;this.$store.watch(this.$store.getters.getUserLogin,(function(e){t.isLogin=e,e?t.userId=t.$store.state.user.id:null!=t.userId&&"undefined"!=typeof t.userId&&(t.userId=null)}))},methods:{showToast:function(t,e){var s;s=1===e?"success":"error",this.$toasted.show(t,{theme:"toasted-primary",icon:"faCheck",type:s,position:"top-right",duration:3e3})},addFriend:function(){var t=this;this.error="";var e=this;u.a.post("/auth/friend/add",this.friend).then((function(s){console.log("response:"+s.data),console.log(e.socket),e.socket.emit("client friend req",{user:s.data}),e.$bvModal.hide("newAddFriendModal"),t.showToast("친구요청을 보냈습니다!",1),t.$store.commit("updateFriends")})).catch((function(e){t.showToast("존재하지 않거나 이미 친구인 이메일 입니다!",0),console.log("Cannot log in"+e),console.log("response::"+JSON.stringify(e.response.data[2].message)),t.error=e.response.data[2].message}))}}},Y=X,tt=(s("184c"),Object(g["a"])(Y,Q,W,!1,null,"37ae5039",null)),et=tt.exports,st={name:"friend",components:{"add-friend":et},data:function(){return{images_path:M.a.IMAGES_PATH}},methods:{friendChat:function(t,e){var s=[this.$store.state.user.id,t];this.$router.push({name:"Room",params:{user_id:s,room_number:e}})},addFriend:function(){this.$bvModal.show("newAddFriendModal")}},mounted:function(){},props:{msg:String}},at=st,ot=(s("9f07"),Object(g["a"])(at,K,Z,!1,null,"4d1b975e",null)),rt=ot.exports,it=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mt-3",attrs:{id:"login-page"}},[s("form",{staticClass:"form-signin",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[s("div",{staticClass:"text-center pb-3"},[t._m(0),s("br"),s("p",{staticClass:"h4"},[t._v("훈민정음에 로그인하기")]),t._v(" "+t._s(t.error)+" ")]),s("b-alert",{attrs:{show:t.wrong,variant:"danger"}},[t._v("존재하지 않는 메일이거나 틀린 비밀번호 입니다.")]),s("b-alert",{attrs:{show:t.reconfirm,variant:"info"}},[t._v("인증되지 않은 계정입니다. "),s("br"),s("router-link",{attrs:{to:{name:"MailReconfirm"}}},[t._v("인증메일 다시 보내기")])],1),s("div",{staticClass:"card p-3 mt-3"},[s("div",{staticClass:"input-group mb-2 d-flex flex-column"},[s("label",{staticClass:"align-self-start",attrs:{for:"email"}},[t._v("이메일")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"form-control",attrs:{type:"email",name:"email",id:"email",required:"",autofocus:""},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}})]),s("div",{staticClass:"input-group mb-4 d-flex flex-column"},[t._m(1),s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{type:"password",name:"password",id:"password",required:""},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})]),s("input",{staticClass:"btn btn-lg btn-primary btn-block",attrs:{type:"submit",value:"submit"}}),s("a",{staticClass:"btn btn-block btn-lg btn-warning btn_login",attrs:{href:t.kakao}},[t._v("KaKao")])]),t._m(2)],1)])},nt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"h1"},[s("i",{staticClass:"fas fa-user"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"d-flex justify-content-between"},[s("label",{attrs:{for:"password"}},[t._v("비밀번호")]),s("a",{staticClass:"ml-auto",attrs:{href:"/reset"}},[t._v("비밀번호 찾기")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card pt-3 mt-3 text-center"},[s("p",[t._v("계정이 없으시다구요? "),s("a",{attrs:{href:"/register"}},[t._v("회원가입")]),t._v("하기!")])])}],ct={name:"Login",created:function(){var t=this;u.a.get("/auth/user").then((function(e){console.log("test:",e.data.user),void 0!==e.data.user&&(t.$store.commit("updateUser"),document.location.href="friend")}))},data:function(){return{result:"hoho",error:null,user:{},reconfirm:!1,wrong:!1,kakao:"http://"+M.a.AUTH_URL+"/auth/account/login/oauth"}},methods:{login:function(){var t=this;this.error="",u.a.post("/auth/account/login",this.user).then((function(e){console.log("response:"+e),t.$store.commit("updateUser"),document.location.href="/friend"})).catch((function(e){var s=JSON.parse(e.response.data[2]);console.log("Cannot log in"+s),0===s.status?(t.reconfirm=!0,t.wrong=!1):(t.wrong=!0,t.reconfirm=!1),console.log(t.reconfirm),t.error=e.response.data[2].message}))}},mounted:function(){}},lt=ct,dt=(s("901a"),Object(g["a"])(lt,it,nt,!1,null,"117eb994",null)),ut=dt.exports,mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"register-page"}},[s("h1",{staticClass:"h3 mb-3 mt-3 font-weight-normal"},[t._v("회원가입 하시지요!")]),s("b-alert",{attrs:{show:t.hasError,variant:"danger"}},[t._v(" "+t._s(t.error)+" ")]),s("form",{staticClass:"form-register card",attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.register(e)}}},[s("div",{staticClass:"input-group mb-3 d-flex flex-column"},[s("label",{staticClass:"align-self-start",attrs:{for:"name"}},[t._v("이름")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],staticClass:"form-control",attrs:{type:"name",name:"name",id:"name",placeholder:"Name",required:""},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}})]),s("div",{staticClass:"input-group mb-3 d-flex flex-column"},[s("label",{staticClass:"align-self-start",attrs:{for:"email"}},[t._v("이메일")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"form-control",attrs:{type:"email",name:"email",id:"email",placeholder:"Email address",required:"",autofocus:""},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}})]),s("div",{staticClass:"input-group mb-3 d-flex flex-column"},[s("label",{staticClass:"align-self-start",attrs:{for:"password"}},[t._v("비밀번호")]),s("div",{staticClass:"d-flex flex-row"},[s("div"),"checkbox"===t.passwordFieldType?s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{name:"password",id:"password",placeholder:"Password",required:"",type:"checkbox"},domProps:{checked:Array.isArray(t.user.password)?t._i(t.user.password,null)>-1:t.user.password},on:{change:function(e){var s=t.user.password,a=e.target,o=!!a.checked;if(Array.isArray(s)){var r=null,i=t._i(s,r);a.checked?i<0&&t.$set(t.user,"password",s.concat([r])):i>-1&&t.$set(t.user,"password",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.user,"password",o)}}}):"radio"===t.passwordFieldType?s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{name:"password",id:"password",placeholder:"Password",required:"",type:"radio"},domProps:{checked:t._q(t.user.password,null)},on:{change:function(e){return t.$set(t.user,"password",null)}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"form-control",attrs:{name:"password",id:"password",placeholder:"Password",required:"",type:t.passwordFieldType},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}}),s("button",{staticClass:"btn btn-light ml-2",attrs:{type:"password"},on:{click:t.switchVisibility}},[s("font-awesome-icon",{attrs:{icon:t.eye}})],1)])]),s("input",{staticClass:"btn btn-lg btn-primary btn-block",attrs:{type:"submit",value:"회원가입"}})])],1)},ft=[],ht={name:"Register",created:function(){},data:function(){return{error:"",user:{},passwordFieldType:"password",eye:"eye",hasError:!1}},methods:{register:function(){var t=this;this.error="",this.checkPassword(this.user.password)?u.a.post("/auth/account/register",this.user).then((function(e){console.log("response:"+e.data),t.$router.push("confirm"),t.$toasted.show("성공적으로 회원가입을 했습니다.",{theme:"toasted-primary",icon:"faCheck",type:"success",position:"top-right",duration:3e3})})).catch((function(e){console.log("Cannot log in"+e),console.log("response::"+JSON.stringify(e.response.data)),t.hasError=!0,t.error=e.response.data})):(this.error="영문, 숫자가 포함된 6자리 이상 16자리 미만의 비밀번호를 입력해 주세요.",this.hasError=!0)},switchVisibility:function(){this.passwordFieldType="password"===this.passwordFieldType?"text":"password",this.eye="password"===this.passwordFieldType?"eye":"eye-slash"},checkPassword:function(t){var e=/^(?=.*[a-zA-Z])(?=.*[0-9]).{6,16}$/;return e.test(t)}},watch:{}},pt=ht,gt=(s("3fbf"),Object(g["a"])(pt,mt,ft,!1,null,"073e4b9e",null)),vt=gt.exports,_t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"p-3",attrs:{id:"confirm-mail-done"}},[s("div",{staticClass:"card mt-3"},[t._v(" "+t._s(t.result)+" "+t._s(t.message)+" ")])])},bt=[],Ct={name:"ConfirmMailDone",created:function(){var t=this.$route.params.token,e=this;console.log(t),u.a.get("/auth/account/confirm/".concat(t)).then((function(t){console.log(t.data),e.result=t.data,e.message="성공적으로 인증되었습니다."})).catch((function(t){e.result=t.data,e.message="해당 URL이 만료되었습니다. 인증메일을 재생성 해주세요!"}))},data:function(){return{result:"",message:""}},methods:{}},kt=Ct,wt=(s("0fb7"),Object(g["a"])(kt,_t,bt,!1,null,"e763d048",null)),xt=wt.exports,yt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},$t=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"p-3",attrs:{id:"confirm-mail"}},[s("div",{staticClass:"card mt-3"},[s("h4",[t._v("성공적으로 인증메일을 보냈습니다.")]),s("p",[t._v("회원가입한 이메일로 인증메일을 보냈습니다 확인해 주세요!")])])])}],Ut={name:"ConfirmMail",created:function(){},data:function(){return{}},methods:{}},It=Ut,Rt=(s("0bb8"),Object(g["a"])(It,yt,$t,!1,null,"131ad766",null)),St=Rt.exports,Ot=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"p-3",attrs:{id:"reconfirm-mail"}},[t._v(" "+t._s(t.err)+" "),s("div",{staticClass:"card"},[s("h4",[t._v("이메일 재인증")]),s("form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.reconfirm(e)}}},[s("div",{staticClass:"input-group mb-2 d-flex flex-column"},[s("label",{staticClass:"align-self-start",attrs:{for:"email"}},[t._v("이메일")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",attrs:{type:"email",name:"email",id:"email",required:"",autofocus:""},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}})]),s("input",{staticClass:"btn btn-lg btn-primary btn-block",attrs:{type:"submit",value:"인증메일 보내기"}})])])])},Et=[],Mt={name:"MailReconfirm",created:function(){},data:function(){return{form:{},err:""}},methods:{reconfirm:function(){var t=this;u.a.post("/auth/account/confirm",this.form).then((function(e){console.log("response"+e.data),t.$router.push("confirm")})).catch((function(e){console.log("err"+e.data),t.err="유효하지 않는 이메일 입니다."}))}}},Tt=Mt,Pt=(s("c84b"),Object(g["a"])(Tt,Ot,Et,!1,null,"78a1206e",null)),qt=Pt.exports,At=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"container pt-5 pb-2",staticStyle:{height:"700px"}},[s("h1",[t._v("채팅방 목록")]),s("div",{staticClass:"scroll pr-3 pl-3 pb-5",attrs:{id:"scrollBox"}},[s("ul",{staticClass:"rooms list-group"},t._l(this.$store.state.rooms,(function(e){return s("router-link",{key:e.id,staticClass:"list-group-item justify-content-between align-items-center list-group-item-action rounded",attrs:{to:{name:"Room",params:{user_id:t.user_id,room_number:e.id}},tag:"li"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6"},[t._v(" "+t._s(e.name)+" ")]),s("div",{staticClass:"col-md-5"},[e.member.length>1?s("div",[t._v(" "+t._s(e.member[0]+" 외 "+(e.member.length-1).toString()+"명")+" ")]):t._e()]),e.unread>0?s("div",{staticClass:"col-md-1 my-auto"},[s("span",{staticClass:"badge badge-danger badge-pill float-right"},[t._v(t._s(e.unread))])]):t._e()])])})),1)]),s("div",{staticClass:"row fixed-bottom pb-4"},[s("div",{staticClass:"col-10"}),s("div",{staticClass:"col-1"},[s("div",[s("button",{staticClass:"btn btn-primary btn-lg rounded-circle shadow-lg",attrs:{type:"button"},on:{click:t.getFriends}},[t._v("+")]),s("b-modal",{attrs:{id:"newRoomModal","hide-footer":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" 새 채팅방 만들기 ")]},proxy:!0}])},[s("div",{staticClass:"d-block text-center"},[s("ul",{staticClass:"list-group mx-3"},t._l(this.$store.state.friends,(function(e){return s("li",{key:e.id,staticClass:"list-group-item justify-content-between"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-2"},[s("img",{staticClass:"rounded-circle border",attrs:{src:e.image_path,width:"40px",height:"40px"}})]),s("div",{staticClass:"col-8 text-left align-self-center"},[t._v(t._s(e.grade)+" "+t._s(e.name))]),s("div",{staticClass:"col-1 ml-2 custom-control custom-checkbox align-self-center"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedUsers,expression:"checkedUsers"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:e.id},domProps:{value:e.id,checked:Array.isArray(t.checkedUsers)?t._i(t.checkedUsers,e.id)>-1:t.checkedUsers},on:{change:function(s){var a=t.checkedUsers,o=s.target,r=!!o.checked;if(Array.isArray(a)){var i=e.id,n=t._i(a,i);o.checked?n<0&&(t.checkedUsers=a.concat([i])):n>-1&&(t.checkedUsers=a.slice(0,n).concat(a.slice(n+1)))}else t.checkedUsers=r}}}),s("label",{staticClass:"custom-control-label",attrs:{for:e.id}})])])])})),0)]),s("b-button",{staticClass:"mt-3",attrs:{block:""},on:{click:t.makeRoom}},[t._v("생성!")])],1)],1)])])])])},Ft=[],Nt={name:"RoomList",created:function(){},data:function(){return{friends:[],checkedUsers:[this.$store.state.user.id],user_id:this.$store.state.user.id}},components:{},methods:{showToast:function(t,e){var s;s=1===e?"success":"error",this.$toasted.show(t,{theme:"toasted-primary",icon:"faCheck",type:s,position:"top-right",duration:3e3})},makeRoom:function(){var t=this,e={userIds:this.checkedUsers};u.a.post("/api/room",e).then((function(e){e&&(t.showToast("생성 완료!",1),t.$store.commit("updateRoom"))})).catch((function(e){t.showToast("생성 실패!",0),console.log(e)})),this.$bvModal.hide("newRoomModal")},getFriends:function(){this.$bvModal.show("newRoomModal")}}},jt=Nt,Lt=Object(g["a"])(jt,At,Ft,!1,null,"16550634",null),Ht=Lt.exports,Dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"Room"}},[s("div",{staticClass:"card bg-light mt-3"},[s("div",{staticClass:"row mx-md-3 shadow-sm"},[s("div",{staticClass:"col-md-2"}),s("h2",{staticClass:"pt-4 col-md-8"},[t._v(t._s(t.room_name))]),s("div",{staticClass:"col-md-2 my-auto"},[s("b-dropdown",{attrs:{id:"dropdown-1",text:"메뉴",right:"",variant:"outline-dark"}},[s("b-dropdown-item",{on:{click:this.showModal}},[t._v("초대하기")]),s("b-modal",{attrs:{id:"inviteModal","hide-footer":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" 채팅방 친구 초대 ")]},proxy:!0}])},[s("div",{staticClass:"d-block text-center"},[s("ul",{staticClass:"list-group mx-3"},t._l(this.$store.state.friends,(function(e){return s("li",{key:e.id,staticClass:"list-group-item justify-content-between"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-2"},[s("img",{staticClass:"rounded-circle border",attrs:{src:e.image_path,width:"40px",height:"40px"}})]),s("div",{staticClass:"col-8 text-left align-self-center"},[t._v(t._s(e.grade)+" "+t._s(e.nickname)+" ")]),s("div",{staticClass:"col-1 ml-2 custom-control custom-checkbox align-self-center"},[t.isExist(e.id)?s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedUsers,expression:"checkedUsers"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:e.id,disabled:""},domProps:{value:e.id,checked:Array.isArray(t.checkedUsers)?t._i(t.checkedUsers,e.id)>-1:t.checkedUsers},on:{change:function(s){var a=t.checkedUsers,o=s.target,r=!!o.checked;if(Array.isArray(a)){var i=e.id,n=t._i(a,i);o.checked?n<0&&(t.checkedUsers=a.concat([i])):n>-1&&(t.checkedUsers=a.slice(0,n).concat(a.slice(n+1)))}else t.checkedUsers=r}}}),s("label",{staticClass:"custom-control-label",attrs:{for:e.id}})]):s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedUsers,expression:"checkedUsers"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:e.id},domProps:{value:e.id,checked:Array.isArray(t.checkedUsers)?t._i(t.checkedUsers,e.id)>-1:t.checkedUsers},on:{change:function(s){var a=t.checkedUsers,o=s.target,r=!!o.checked;if(Array.isArray(a)){var i=e.id,n=t._i(a,i);o.checked?n<0&&(t.checkedUsers=a.concat([i])):n>-1&&(t.checkedUsers=a.slice(0,n).concat(a.slice(n+1)))}else t.checkedUsers=r}}}),s("label",{staticClass:"custom-control-label",attrs:{for:e.id}})])])])])})),0)]),s("b-button",{staticClass:"mt-3",attrs:{block:""},on:{click:t.inviteUser}},[t._v("생성!")])],1),s("b-dropdown-divider"),s("b-dropdown-item",{on:{click:this.quitRoom}},[t._v("채팅방 나가기")])],1)],1),t._l(t.members,(function(e){return s("div",{key:e.id,staticClass:"ml-1 mb-1"},[0==e.latest_chat_stime?s("span",{staticClass:"badge badge-pill badge-success"},[t._v(" "+t._s(e.nickname[0])+" ")]):t._e()])}))],2),s("p"),s("div",{staticClass:"scroll px-3 pb-5",attrs:{id:"scrollBox"}},[s("ul",{staticClass:"list-group list-group-flush list-unstyled"},[t._l(t.messages,(function(e,a){return s("li",{key:e.s_time,staticClass:"mb-2"},[t.user_id!==e.chatUserId?s("div",[0==a?s("div",{staticClass:"mb-2"},[t._v(" "+t._s(e.chatUserName)+" ")]):t.messages[a-1].chatUserId!=e.chatUserId?s("div",{staticClass:"mb-2"},[t._v(" "+t._s(e.chatUserName)+" ")]):s("div"),s("div",{class:{"p-3 rounded-lg rounded float-left text-left border border-success":1==e.chatStatus,"p-3 rounded-lg rounded float-left text-left border border-danger":0==e.chatStatus,"p-3 rounded-lg rounded float-left text-left border border-secondary":-1==e.chatStatus}},[s("div",{on:{click:function(e){return t.openCheck(a,1)}}},[s("span",{staticClass:"text-dark"},[t._v(" "+t._s(e.chatMsg)),s("br")]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.showIdx1.indexOf(a)>=0,expression:"showIdx1.indexOf(idx) >= 0"}],staticClass:"text-secondary"},[t._v(" "+t._s(e.chatCheck)+" ")])])]),t._l(t.members,(function(o){return s("div",{key:o.id,staticClass:"float-left ml-1 mt-4 pt-2"},[o.latest_chat_stime==e.chatStime?s("span",{class:{"badge badge-pill badge-primary":o.latest_chat_stime%5==0,"badge badge-pill badge-secondary":o.latest_chat_stime%5==1,"badge badge-pill badge-warning":o.latest_chat_stime%5==2,"badge badge-pill badge-info":o.latest_chat_stime%5==3,"badge badge-pill badge-dark":o.latest_chat_stime%5==4}},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e(),0==o.latest_chat_stime&&0==t.socket_messages.length&&a+1==t.messages.length?s("span",{staticClass:"badge badge-pill badge-success"},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e()])}))],2):s("div",[s("div",{class:{"p-3 rounded-lg rounded float-right text-right bg-success":1==e.chatStatus,"p-3 rounded-lg rounded float-right text-right bg-danger":0==e.chatStatus,"p-3 rounded-lg rounded float-right text-right bg-secondary":-1==e.chatStatus}},[s("div",{on:{click:function(e){return t.openCheck(a,1)}}},[s("span",{staticClass:"text-dark"},[t._v(" "+t._s(e.chatMsg)+" ")]),s("br"),s("span",{directives:[{name:"show",rawName:"v-show",value:t.showIdx1.indexOf(a)>=0,expression:"showIdx1.indexOf(idx) >= 0"}],staticClass:"text-secondary"},[t._v(" "+t._s(e.chatCheck)+" ")])])]),t._l(t.members,(function(o){return s("div",{key:o.id,staticClass:"float-right mr-1 mt-4 pt-2"},[o.latest_chat_stime==e.chatStime?s("span",{class:{"badge badge-pill badge-primary":o.latest_chat_stime%5==0,"badge badge-pill badge-secondary":o.latest_chat_stime%5==1,"badge badge-pill badge-warning":o.latest_chat_stime%5==2,"badge badge-pill badge-info":o.latest_chat_stime%5==3,"badge badge-pill badge-dark":o.latest_chat_stime%5==4}},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e(),0==o.latest_chat_stime&&0==t.socket_messages.length&&a+1==t.messages.length?s("span",{staticClass:"badge badge-pill badge-success"},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e()])}))],2)])})),t._l(t.socket_messages,(function(e,a){return s("li",{key:e.s_time,staticClass:"mb-2"},[e.chatUserId!=t.user_id?s("div",[s("div",0==a?[0==t.messages.length||t.messages[t.messages.length-1].chatUserId!=e.chatUserId?s("div",{staticClass:"mb-2"},[t._v(" "+t._s(e.chatUserName)+" ")]):s("div")]:[t.socket_messages[a-1].chatUserId!=e.chatUserId?s("div",{staticClass:"mb-2"},[t._v(" "+t._s(e.chatUserName)+" ")]):s("div")]),s("div",{class:{"p-3 rounded-lg rounded infoBox text-center bg-light":3==e.chatStatus,"p-3 rounded-lg rounded msgBox float-left text-left border border-success":1==e.chatStatus,"p-3 rounded-lg rounded msgBox float-left text-left border border-danger":0==e.chatStatus,"p-3 rounded-lg rounded msgBox float-left text-left border border-secondary":-1==e.chatStatus}},[s("div",{on:{click:function(e){return t.openCheck(a,2)}}},[s("span",{staticClass:"text-dark"},[t._v(" "+t._s(e.chatMsg)+" ")]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.showIdx2.indexOf(a)>=0,expression:"showIdx2.indexOf(idx) >= 0"}],staticClass:"text-secondary"},[t._v(" "+t._s(e.chatCheck)+" ")])])]),t._l(t.members,(function(o){return s("div",{key:o.id,staticClass:"float-left ml-1 mt-4 pt-2"},[0==o.latest_chat_stime&&a+1==t.socket_messages.length?s("span",{staticClass:"badge badge-pill badge-success"},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e(),o.latest_chat_stime==e.s_time?s("span",{class:{"badge badge-pill badge-primary":o.latest_chat_stime%5==0,"badge badge-pill badge-secondary":o.latest_chat_stime%5==1,"badge badge-pill badge-warning":o.latest_chat_stime%5==2,"badge badge-pill badge-info":o.latest_chat_stime%5==3,"badge badge-pill badge-dark":o.latest_chat_stime%5==4}},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e()])}))],2):s("div",[s("div",{class:{"p-3 rounded-lg rounded infoBox text-center bg-light":3==e.chatStatus,"p-3 rounded-lg rounded msgBox float-right text-right bg-success":1==e.chatStatus,"p-3 rounded-lg rounded msgBox float-right text-right bg-danger":0==e.chatStatus,"p-3 rounded-lg rounded msgBox float-right text-right bg-secondary":-1==e.chatStatus}},[s("div",{on:{click:function(e){return t.openCheck(a,2)}}},[s("span",{staticClass:"text-dark"},[t._v(" "+t._s(e.chatMsg)+" ")]),s("br"),s("span",{directives:[{name:"show",rawName:"v-show",value:t.showIdx2.indexOf(a)>=0,expression:"showIdx2.indexOf(idx) >= 0"}],staticClass:"text-secondary"},[t._v(" "+t._s(e.chatCheck)+" ")])])]),t._l(t.members,(function(o){return s("div",{key:o.id,staticClass:"float-right mr-1 mt-4 pt-2"},[0==o.latest_chat_stime&&a+1==t.socket_messages.length?s("span",{staticClass:"badge badge-pill badge-success"},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e(),o.latest_chat_stime==e.s_time?s("span",{class:{"badge badge-pill badge-primary":o.latest_chat_stime%5==0,"badge badge-pill badge-secondary":o.latest_chat_stime%5==1,"badge badge-pill badge-warning":o.latest_chat_stime%5==2,"badge badge-pill badge-info":o.latest_chat_stime%5==3,"badge badge-pill badge-dark":o.latest_chat_stime%5==4}},[t._v(" "+t._s(o.nickname[0])+" ")]):t._e()])}))],2)])}))],2)]),s("div",{staticClass:"card-body chat-input"},[s("b-form",{on:{submit:function(e){return e.preventDefault(),t.send(e)}}},[s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newMessage,expression:"newMessage"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Enter message here",autocomplete:"off",required:""},domProps:{value:t.newMessage},on:{input:function(e){e.target.composing||(t.newMessage=e.target.value)}}})])])],1)])])},Bt=[],zt=(s("a4d3"),s("e01a"),s("d28b"),s("99af"),s("7db0"),s("4160"),s("c975"),s("d3b7"),s("3ca3"),s("159b"),s("ddb0"),{name:"Room",created:function(){var t=this;"undefined"==typeof this.$route.params.room_number||null==this.$route.params.room_number?u.a.post("/api/room",{userIds:this.$route.params.user_id}).then((function(e){e&&t.$toasted.show("생성 완료!",{theme:"toasted-primary",icon:"faCheck",type:"success",position:"top-right",duration:3e3}),t.room_id=e.data.id,t.$store.state.user.myroom=t.room_id,t.initRoom(),t.$store.commit("updateFriends",t.$store.commit("updateRoom"))})).catch((function(e){t.$toasted.show("생성 실패!",{theme:"toasted-primary",type:"error",position:"top-right",duration:3e3}),console.log(e)})):this.initRoom()},data:function(){return{user_id:this.$store.state.user.id,user_name:"",room_id:this.$route.params.room_number,room_name:"",messages:[],newMessage:"",checkedUsers:[],members:[],current_members:[],socket_messages:[],socket_chat:"",showIdx1:[],showIdx2:[]}},methods:{showToast:function(t,e){var s;s=1===e?"success":"error",this.$toasted.show(t,{theme:"toasted-primary",icon:"faCheck",type:s,position:"top-right",duration:3e3})},isExist:function(t){return this.members.find((function(e){return e.id===t}))},socketOn:function(){var t=this;this.socket_chat.emit("client chat enter"),this.socket_chat.on("server chat enter",(function(e){if(t.current_members=e.current_member_list,e.user!=t.user_id){var s=t.members.findIndex((function(t){return t.id==e.user}));t.members[s].latest_chat_stime=0,console.log("남이 입장 후 방의 멤버 ",t.members),console.log("현재멤버",t.current_members)}else t.current_members.forEach((function(e){var s=t.members.findIndex((function(t){return t.id==e}));t.members[s].latest_chat_stime=0})),console.log("내가 입장 후 방의 멤버",t.members)})),this.socket_chat.on("server chat message",(function(e){t.socket_messages.push({chatMsg:e.msg,chatUserName:e.user_name,chatUserId:e.user,chatId:e.chatId,s_time:e.s_time,chatStatus:-1})})),this.socket_chat.on("server disconnected",(function(e){var s=t.current_members.indexOf(e.user);t.current_members.splice(s,1),s=t.members.findIndex((function(t){return t.id==e.user})),0!=t.socket_messages.length?t.members[s].latest_chat_stime=t.socket_messages[t.socket_messages.length-1].s_time:t.members[s].latest_chat_stime=t.messages[t.messages.length-1].chatStime,console.log("퇴장 알람 후 방의 멤버",t.members)})),this.socket_chat.on("checked msg",(function(e){t.socket_messages.forEach((function(t){-1===t.chatStatus&&t.s_time===e.s_time&&(t.chatStatus=e.chatStatus,t.chatMsg!=e.chatCheck&&(t.chatCheck=e.chatCheck))}))})),this.socket_chat.on("quit",(function(){t.$router.go(-1),t.showToast("방에서 나갔습니다",1)}))},initRoom:function(){var t=this;this.$store.state.location=this.$route.params.room_number;var e=this.$store.state.rooms.findIndex((function(e){return e.id===t.$route.params.room_number}));-1!==e&&(this.$store.state.countChat-=this.$store.state.rooms[e].unread,this.$store.state.rooms[e].unread=0),this.socket_chat=O()(M.a.CHAT_URL+"/chat?room=".concat(this.room_id,"&user=").concat(this.user_id),{transports:["websocket"]}),this.$http.get("/api/room/".concat(this.user_id,"/").concat(this.room_id)).then((function(e){t.user_name=e.data.userName,t.room_name=e.data.roomName,t.messages=e.data.chatList,t.members=e.data.memberList})).then((function(){t.socketOn()})),window.onbeforeunload=function(){t.socket_chat.emit("disconnect",{user_name:t.user_name})}},push_data:function(t){this.socket_messages.push(t)},send:function(t){var e=(new Date).getTime()%1e6+1e6*this.$store.state.user.id;this.socket_chat.emit("client chat message",{msg:this.newMessage,user_name:this.user_name,s_time:e}),this.newMessage="",t.target.reset(),this.scrollToEnd()},scrollToEnd:function(){var t=this.$el.querySelector("#scrollBox");t.scrollTop=t.scrollHeight},openCheck:function(t,e){1==e?this.showIdx1.indexOf(t)>=0?this.showIdx1.splice(this.showIdx1.indexOf(t),1):this.showIdx1.push(t):2==e&&(this.showIdx2.indexOf(t)>=0?this.showIdx2.splice(this.showIdx2.indexOf(t),1):this.showIdx2.push(t))},quitRoom:function(){this.$store.state.location=-1,this.socket_chat.emit("quit room")},showModal:function(){this.$bvModal.show("inviteModal")},inviteUser:function(){var t=this;this.checkedUsers.length<1?this.showToast("선택한 항목이 없습니다.",0):(u.a.post("/api/room/in/".concat(this.room_id),{userIds:this.checkedUsers}).then((function(e){if(e){t.showToast("초대하였습니다.",1);var s=!0,a=!1,o=void 0;try{for(var r,i=function(){var s=r.value,a=t.$store.state.friends.findIndex((function(t){return t.id===s}));if(-1===a)return"continue";t.members.push({id:s,nickname:t.$store.state.friends[a].nickname,latest_chat_stime:e.data.memberLatestChatStime})},n=e.data.memberId[Symbol.iterator]();!(s=(r=n.next()).done);s=!0)i()}catch(c){a=!0,o=c}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}t.checkedUsers=[]}})).catch((function(e){t.showToast("초대에 실패하였습니다.",0),console.log(e)})),this.$bvModal.hide("inviteModal"))}},mounted:function(){},beforeDestroy:function(){this.$store.state.location=-1,this.socket_chat.close(),this.$store.commit("updateRoom")}}),Gt=zt,Jt=(s("933d"),Object(g["a"])(Gt,Dt,Bt,!1,null,"de9a2d12",null)),Vt=Jt.exports,Kt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"friend-requests mt-3"}},[s("h1",{staticClass:"pt-3 mt-3"},[t._v("친구 요청이 왔어요")]),s("ul",{staticClass:"list-group m-3"},t._l(t.friends,(function(e,a){return s("li",{key:e,staticClass:"list-group-item d-flex justify-content-between"},[s("div",[t._v(t._s(e.name))]),s("div",[t._v(t._s(e.email))]),s("div",[s("button",{staticClass:"btn btn-light mr-2",on:{click:function(s){return t.accept(s,e,a)}}},[t._v("좋소")]),s("button",{staticClass:"btn btn-light",on:{click:function(s){return t.refuse(s,e,a)}}},[t._v("싫소")])])])})),0)])},Zt=[],Qt={name:"FriendRequests",created:function(){var t=this;u.a.get("/auth/friend/request").then((function(e){t.friends=e.data})).catch((function(t){console.log(t)}))},data:function(){return{friends:[],socket:O()(M.a.CHAT_URL+"/friend",{transports:["websocket"]})}},methods:{accept:function(t,e,s){var a=this;u.a.post("/auth/friend/request/reply",{id:e.id,status:1}).then((function(){a.$store.state.countReq--,a.friends.splice(s,1),a.socket.emit("client friend req permit",{user:e.id}),a.$store.commit("updateFriends")})).catch((function(t){console.log(t)}))},refuse:function(t,e,s){var a=this;u.a.post("/auth/friend/request/reply",{id:e.id,status:0}).then((function(){a.$store.state.countReq--,a.friends.splice(s,1)})).catch((function(t){console.log(t)}))}}},Wt=Qt,Xt=(s("d6c7"),Object(g["a"])(Wt,Kt,Zt,!1,null,"763f45a4",null)),Yt=Xt.exports;a["default"].use(H["a"]);var te=new H["a"]({mode:"history",base:"/",routes:[{path:"/",name:"Login",component:ut},{path:"/friend",name:"Friend",component:rt},{path:"/users",name:"users",component:V},{path:"/register",name:"Register",component:vt},{path:"/roomlist/:user_id",name:"RoomList",component:Ht},{path:"/room/:user_id/:room_number",name:"Room",component:Vt},{path:"/friend/add",name:"AddFriend",component:et},{path:"/friend/requests",name:"FriendRequests",component:Yt},{path:"/profile/edit",name:"EditProfile",component:_},{path:"/account/confirm/:token",name:"MailConfirmDone",component:xt},{path:"/confirm",name:"MailConfirm",component:St},{path:"/reconfirm",name:"MailReconfirm",component:qt}]}),ee=s("5f5b"),se=s("b1e0"),ae=s("6aac"),oe=s("e6c7"),re=s("875d"),ie=s.n(re),ne=s("2f62"),ce=["오랑캐","백정","평민","선비","학자","세종"];a["default"].use(ne["a"]);var le=new ne["a"].Store({state:{loggedin:!1,user:void 0,user_img:null,countChat:0,countReq:0,rooms:void 0,friends:void 0,location:-1},mutations:{updateUser:function(t){var e=this;u.a.get("/auth/user").then((function(s){if(void 0!==s.data.user){t.user=s.data.user,t.user_img=M.a.IMAGES_PATH+s.data.user.image_path;var a=s.data.user.grade;t.user.grade=ce[a-1],1===a&&(t.user_img="".concat(M.a.IMAGES_PATH,"orangke.png")),t.loggedin=!0,e.commit("updateFriends",e.commit("updateRoom"))}else t.loggedin=!1,t.user=void 0})).catch((function(t){console.log(t)}))},updateRoom:function(t){t.loggedin&&u.a.get("/api/room/".concat(t.user.id)).then((function(e){t.rooms=e.data,t.countChat=t.rooms[t.rooms.length-1],t.rooms.splice(t.rooms.length-1,1)})).catch((function(t){console.log(t)}))},updateReq:function(t){u.a.get("/auth/friend/request/cnt").then((function(e){t.countReq=e.data["COUNT(*)"]})).catch((function(t){console.log(t)}))},updateFriends:function(t,e){u.a.get("/auth/friend").then((function(s){t.friends=s.data,e&&e()})).catch((function(t){console.log(t)}))}},getters:{getUserInfo:function(t){return function(){return t.user}},getUserImg:function(t){return function(){return t.user_img}},getUserLogin:function(t){return function(){return t.loggedin}},getUnread:function(t){return function(){return t.countChat}},getReq:function(t){return function(){return t.countReq}},getFriends:function(t){return function(){return t.friends}}}}),de=(s("ab8b"),s("2dd8"),s("ecee")),ue=s("c074"),me=s("ad3d"),fe=(s("f9e3"),s("f2bc"),s("a65d")),he=s.n(fe);a["default"].component("font-awesome-icon",me["a"]),de["c"].add(ue["h"]),de["c"].add(ue["g"]),de["c"].add(ue["f"]),de["c"].add(ue["i"]),de["c"].add(ue["e"]),de["c"].add(ue["b"]),de["c"].add(ue["a"]),de["c"].add(ue["c"]),de["c"].add(ue["d"]),a["default"].use(ie.a),a["default"].use(ee["a"]),a["default"].use(se["a"]),a["default"].use(he.a,{iconPack:"fontawesome"}),a["default"].component("b-modal",ae["a"]),a["default"].directive("b-modal",oe["a"]),a["default"].config.productionTip=!1,a["default"].prototype.$http=u.a,new a["default"]({render:function(t){return t(L)},router:te,store:le}).$mount("#app")},"6ea3":function(t,e,s){},"776b":function(t,e,s){},"7e68":function(t,e,s){},"85ec":function(t,e,s){},"8b9e":function(t,e,s){},"8c4b":function(t,e,s){"use strict";var a=s("c3f7"),o=s.n(a);o.a},"901a":function(t,e,s){"use strict";var a=s("7e68"),o=s.n(a);o.a},"933d":function(t,e,s){"use strict";var a=s("cf8b"),o=s.n(a);o.a},"9f07":function(t,e,s){"use strict";var a=s("d006"),o=s.n(a);o.a},a6c3:function(t,e,s){},a9f1:function(t,e,s){"use strict";var a=s("a6c3"),o=s.n(a);o.a},ad46:function(t,e,s){},c3f7:function(t,e,s){},c84b:function(t,e,s){"use strict";var a=s("ff4f"),o=s.n(a);o.a},cf8b:function(t,e,s){},d006:function(t,e,s){},d6c7:function(t,e,s){"use strict";var a=s("ad46"),o=s.n(a);o.a},db49:function(t,e,s){(function(e){s("a15b");var a=s("df7c"),o="release";t.exports={NODE_ENV:o,DOMAIN_NAME:"development"===o?"localhost:8080":"hunmintalk.tk",IP:"development"===o?"localhost":"34.219.138.15",AUTH_PORT:3300,CHAT_PORT:3e3,SPELL_PORT:3200,AUTH_URL:"development"===o?"localhost:3300":"34.219.138.15:3300",CHAT_URL:"development"===o?"localhost:3000":"34.219.138.15:3000",SPELL_URL:"development"===o?"localhost:3200":"34.219.138.15:3200",CONFIG_PATH:a.join(e,"../../../config/"),IMAGES_PATH:"development"===o?"http://localhost:3000/images/":"https://hunmin.s3-us-west-2.amazonaws.com/"}}).call(this,"/")},f2bc:function(t,e){},f554:function(t,e,s){},f63f:function(t,e,s){},ff4f:function(t,e,s){}});
//# sourceMappingURL=app.7e1733b0.js.map